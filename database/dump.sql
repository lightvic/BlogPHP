CREATE DATABASE IF NOT EXISTS `data` 
CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

use data;

CREATE TABLE IF NOT EXISTS `user` (
	`id` INT NOT NULL AUTO_INCREMENT,
	`email` VARCHAR(255) NOT NULL UNIQUE,
	`password` VARCHAR(256) NOT NULL,
	`nickname` VARCHAR(255),
	`admin` ENUM('true','false') DEFAULT 'false',
	PRIMARY KEY (`id`)
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS `post` (
	`id` INT NOT NULL AUTO_INCREMENT,
	`content` TEXT,
	`date` DATETIME DEFAULT CURRENT_TIMESTAMP,
	`user` INT NOT NULL,
	PRIMARY KEY (`id`),
	CONSTRAINT FOREIGN KEY (`user`) REFERENCES `user`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB;

CREATE TABLE IF NOT EXISTS `comment` (
	`id` INT NOT NULL AUTO_INCREMENT,
	`content` TEXT,
	`date` DATETIME DEFAULT CURRENT_TIMESTAMP,
	`user` INT NOT NULL,
	`post` INT NOT NULL,
	PRIMARY KEY (`id`),
	CONSTRAINT FOREIGN KEY (`user`) REFERENCES `user`(`id`) ON DELETE CASCADE,
	CONSTRAINT FOREIGN KEY (`post`) REFERENCES `post`(`id`) ON DELETE CASCADE,
	CONSTRAINT FOREIGN KEY (`parent_comment`) REFERENCES `comment`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB;
